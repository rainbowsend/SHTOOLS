.\" Automatically generated by Pandoc 2.10
.\"
.TH "shmultitapermaskcse" "1" "2020-09-07" "Fortran 95" "SHTOOLS 4.7"
.hy
.SH SHMultiTaperMaskCSE
.PP
Perform a localized multitaper cross-spectral analysis using using
arbitrary windows derived from a mask.
.SH Usage
.PP
call SHMultiTaperMaskCSE (\f[C]mtse\f[R], \f[C]sd\f[R], \f[C]cilm1\f[R],
\f[C]lmax1\f[R], \f[C]cilm2\f[R], \f[C]lmax2\f[R], \f[C]tapers\f[R],
\f[C]lmaxt\f[R], \f[C]k\f[R], \f[C]taper_wt\f[R], \f[C]norm\f[R],
\f[C]csphase\f[R], \f[C]exitstatus\f[R])
.SH Parameters
.TP
\f[B]\f[CB]mtse\f[B]\f[R] : output, real(dp), dimension (\f[B]\f[CB]lmax\f[B]\f[R]-\f[B]\f[CB]lmaxt\f[B]\f[R]+1)
The localized multitaper cross-power spectrum estimate.
\f[C]lmax\f[R] is the smaller of \f[C]lmax1\f[R] and \f[C]lmax2\f[R].
.TP
\f[B]\f[CB]sd\f[B]\f[R] : output, real(dp), dimension (\f[B]\f[CB]lmax\f[B]\f[R]-\f[B]\f[CB]lmaxt\f[B]\f[R]+1)
The standard error of the localized multitaper cross-power spectral
estimates.
\f[C]lmax\f[R] is the smaller of \f[C]lmax1\f[R] and \f[C]lmax2\f[R].
.TP
\f[B]\f[CB]cilm1\f[B]\f[R] : input, real(dp), dimension (2, \f[B]\f[CB]lmax1\f[B]\f[R]+1, \f[B]\f[CB]lmax1\f[B]\f[R]+1)
The spherical harmonic coefficients of the first function.
.TP
\f[B]\f[CB]lmax1\f[B]\f[R] : input, integer
The spherical harmonic bandwidth of \f[C]cilm1\f[R].
.TP
\f[B]\f[CB]cilm2\f[B]\f[R] : input, real(dp), dimension (2, \f[B]\f[CB]lmax2\f[B]\f[R]+1, \f[B]\f[CB]lmax2\f[B]\f[R]+1)
The spherical harmonic coefficients of the second function.
.TP
\f[B]\f[CB]lmax2\f[B]\f[R] : input, integer
The spherical harmonic bandwidth of \f[C]cilm2\f[R].
.TP
\f[B]\f[CB]tapers\f[B]\f[R] : input, real(dp), dimension ((\f[B]\f[CB]lmaxt\f[B]\f[R]+1)**2, \f[B]\f[CB]k\f[B]\f[R])
An array of the \f[C]k\f[R] windowing functions, arranged in columns,
obtained from a call to \f[C]SHReturnTapersMap\f[R].
The spherical harmonic coefficients are packed according to the
conventions in \f[C]SHCilmToVector\f[R].
.TP
\f[B]\f[CB]lmaxt\f[B]\f[R] : input, integer
The spherical harmonic bandwidth of the windowing functions in the array
\f[C]tapers\f[R].
.TP
\f[B]\f[CB]k\f[B]\f[R] : input, integer
The number of tapers to be utilized in performing the multitaper
spectral analysis.
.TP
\f[B]\f[CB]taper_wt\f[B]\f[R] : input, optional, real(dp), dimension (\f[B]\f[CB]k\f[B]\f[R])
The weights used in calculating the multitaper spectral estimates and
standard error.
Optimal values of the weights (for a known global power spectrum) can be
obtained from the routine \f[C]SHMTVarOpt\f[R].
.TP
\f[B]\f[CB]norm\f[B]\f[R] : input, optional, integer, default = 1
1 (default) = 4-pi (geodesy) normalized harmonics; 2 = Schmidt
semi-normalized harmonics; 3 = unnormalized harmonics; 4 = orthonormal
harmonics.
.TP
\f[B]\f[CB]csphase\f[B]\f[R] : input, optional, integer, default = 1
1 (default) = do not apply the Condon-Shortley phase factor to the
associated Legendre functions; -1 = append the Condon-Shortley phase
factor of (-1)\[ha]m to the associated Legendre functions.
.TP
\f[B]\f[CB]exitstatus\f[B]\f[R] : output, optional, integer
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
.PP
\f[C]SHMultiTaperMaskCSE\f[R] will perform a localized multitaper
cross-spectral analysis of two input functions expressed in spherical
harmonics, \f[C]cilm1\f[R] and \f[C]cilm2\f[R], using an arbitrary set
of windows derived from a mask.
The maximum degree of the localized multitaper power spectrum estimate
is \f[C]lmax-lmaxt\f[R], where \f[C]lmax\f[R] is the smaller of
\f[C]lmax1\f[R] and \f[C]lmax2\f[R].
The matrix \f[C]tapers\f[R] contains the spherical harmonic coefficients
of the windows and can be obtained by a call to
\f[C]SHReturnTapersMap\f[R].
The coefficients of each window are stored in a single column, ordered
according to the conventions used in \f[C]SHCilmToVector\f[R].
.PP
If the optional array \f[C]taper_wt\f[R] is specified, then these
weights will be used in calculating a weighted average of the individual
\f[C]k\f[R] tapered estimates (\f[C]mtse\f[R]) and the corresponding
standard error of the estimates (\f[C]sd\f[R]).
If not present, the weights will all be assumed to be equal.
When \f[C]taper_wt\f[R] is not specified, the mutltitaper spectral
estimate for a given degree will be calculated as the average obtained
from the \f[C]k\f[R] individual tapered estimates.
The standard error of the multitaper estimate at degree l is simply the
population standard deviation,
\f[C]S = sqrt(sum (Si - mtse)\[ha]2 / (k-1))\f[R], divided by
sqrt(\f[C]k\f[R]).
See Wieczorek and Simons (2007) for the relevant expressions when
weighted estimates are used.
.PP
The employed spherical harmonic normalization and Condon-Shortley phase
convention can be set by the optional arguments \f[C]norm\f[R] and
\f[C]csphase\f[R]; if not set, the default is to use geodesy 4-pi
normalized harmonics that exclude the Condon-Shortley phase of
(-1)\[ha]m.
.SH References
.PP
Wieczorek, M.
A.
and F.
J.
Simons, Minimum-variance multitaper spectral estimation on the sphere,
J.
Fourier Anal.
Appl., 13, doi:10.1007/s00041-006-6904-1, 665-692, 2007.
.SH See also
.PP
shmultitapermaskse, shreturntapersmap, shcilmtovector
